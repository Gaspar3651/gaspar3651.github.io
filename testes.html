<!DOCTYPE html>
<!-- saved from url=(0087)https://storage.googleapis.com/br-digitalcomm-prd-product-images/chat-widget/index.html -->
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<style type="text/css">
			.embeddedServiceHelpButton .helpButton .uiButton {
				background-color: #1e5bc6;
				font-family: "Univers", sans-serif;
			}

			.embeddedServiceHelpButton .helpButton .uiButton:focus {
				outline: 1px solid #1e5bc6;
			}

			body {
				z-index: 0;
			}
		</style>
		<title>Chatbot Carina</title>
	</head>
	<body>
		<script type="text/javascript" src="./index-carina-prod_files/esw.min.js.baixados"></script>
		<script type="text/javascript">
			function isProduction() {
				if (typeof window !== "undefined") {
					var hostname = window.location.hostname;
					console.log('hostname: ' + hostname);
					return !(hostname.includes("localhost") || hostname.includes("ngrok") || hostname.includes("-qa"));
				}
			}

			function setPreChat(){
				let urlParams = new URLSearchParams(window.location.search);
				let origem = urlParams.get("origem");
				let menu = urlParams.get("menu");

				if (origem === "App" || origem === "APP") {
					window.addEventListener( "onEmbeddedMessagingReady" , ( ) => { 
						console.log ( "Received the APP event…"); 
						embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { 
							"Origem" : "App - Meu Carrefour"
						}); 
					});

				} else if ((origem === "DMA" || origem === "SiteAreaLogada" || origem === "Site") && menu) {
					window.addEventListener( "onEmbeddedMessagingReady" , ( ) => { 
						console.log ( "Received the DMA, SiteAreaLogada, Site event…"); 
						embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { 
							"Origem" : origem,
							"RedirectDMAVarejo" : menu
						}); 
					});

				} else {
					alert("Erro ao carregar o chat");
				}
			}

			function initEmbeddedMessaging() {
				console.log('initEmbeddedMessaging chamado');
				console.log('Ambiente de produção?', isProduction());

				var chatbotAvatarImgURL = isProduction()
				? "https://carrefourservice.file.force.com/sfc/dist/version/renditionDownload?rendition=ORIGINAL_Png&versionId=068Hs00000fx94B&operationContext=DELIVERY&contentId=05THs00002lPmjr&page=0&d=/a/Hs000001VZbu/C5n4w2SKs.ovyGe0nNp69.J_zmAKt9KaevMNpaDhF30&oid=00DHs00000NDcMH&dpt=null&viewId="
          		: "https://carrefourservice.file.force.com/sfc/dist/version/renditionDownload?rendition=ORIGINAL_Png&versionId=068Hs00000fx94B&operationContext=DELIVERY&contentId=05THs00002lPmjr&page=0&d=/a/Hs000001VZbu/C5n4w2SKs.ovyGe0nNp69.J_zmAKt9KaevMNpaDhF30&oid=00DHs00000NDcMH&dpt=null&viewId=";
				
				var scrt2URL = isProduction()
				? 'https://carrefourservice.my.salesforce-scrt.com'
				: 'https://carrefourservice--varejohml.sandbox.my.salesforce-scrt.com';

				var urlInitSites = isProduction()
				? 'https://carrefourservice.my.site.com/ESWChatCarrefourEnhance1768352483371'
				: 'https://carrefourservice--varejohml.sandbox.my.site.com/ESWChatCarrefourEnhance1750101728853';

				var codeGslbBaseURL = isProduction()
				? '00DHs00000NDcMH'
				: '00DD50000009T77';

				var botName = isProduction()
				? 'Chat_Carrefour_Enhanced'
				: 'Chat_Carrefour_Enhanced';

				setPreChat();

				embeddedservice_bootstrap.settings.hideChatButtonOnLoad = true;
				embeddedservice_bootstrap.settings.displayHelpButton = false;
				embeddedservice_bootstrap.settings.language = 'pt-BR';

				embeddedservice_bootstrap.settings.enabledFeatures = ['LiveAgent'];
				embeddedservice_bootstrap.settings.entryFeature = 'LiveAgent';

				embeddedservice_bootstrap.settings.chatbotAvatarImgURL = chatbotAvatarImgURL;
				embeddedservice_bootstrap.settings.smallCompanyLogoImgURL = chatbotAvatarImgURL;

				embeddedservice_bootstrap.init(
					codeGslbBaseURL,
					botName,
					urlInitSites,
					{
						scrt2URL: scrt2URL
					}
				);

				console.log('embeddedservice_bootstrap.init finalizado');
				setTimeout(function () {
					handleOpenChat();
				}, 3000);
			};

			(function () {
				var urlEmbeddedservice = isProduction()
				? 'https://carrefourservice.my.site.com/ESWChatCarrefourEnhance1768352483371/assets/js/bootstrap.min.js'
				: 'https://carrefourservice--varejohml.sandbox.my.site.com/ESWChatCarrefourEnhance1750101728853/assets/js/bootstrap.min.js';

				console.log('URL do script esw.min.js:', urlEmbeddedservice);

				if (!window.embeddedservice_bootstrap) {
					console.log('embeddedservice_bootstrap não encontrado. Carregando script...');
					var s = document.createElement('script');
					s.setAttribute('src', urlEmbeddedservice);
					s.onload = function () {
						console.log('Script esw.min.js carregado');
						initEmbeddedMessaging();
					};

					s.onerror = function () {
						console.error('Erro ao carregar esw.min.js');
					};

					document.body.appendChild(s);
				} else {
					console.log('embeddedservice_bootstrap já está disponível. Inicializando...');
					initEmbeddedMessaging();
				}
			})();

			function handleOpenChat () {
				console.log('handleOpenChat acionado');
				if (window.embeddedservice_bootstrap) {
					console.log('Chamando bootstrapEmbeddedService');
					embeddedservice_bootstrap.utilAPI.launchChat();
				} else {
					console.warn('embeddedservice_bootstrap não está disponível no handleOpenChat');
				}
			};
		</script>
		<script src="./index-carina-prod_files/esw.min(1).js.baixados"></script>
	</body>
</html>
