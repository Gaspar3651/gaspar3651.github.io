<!DOCTYPE html>
<!-- saved from url=(0087)https://storage.googleapis.com/br-digitalcomm-prd-product-images/chat-widget/index.html -->
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<style type="text/css">
			.embeddedServiceHelpButton .helpButton .uiButton {
				background-color: #1e5bc6;
				font-family: "Univers", sans-serif;
			}
			.embeddedServiceHelpButton .helpButton .uiButton:focus {
				outline: 1px solid #1e5bc6;
			}
		</style>
		<title>Chatbot Samy</title>
	</head>
	<body>
		<!-- <p onclick="handleOpenChat()" style="cursor: pointer;">Clique aqui para iniciar o Chat</p> -->

		<span class="loader"></span>
		<style>
			.loader {
				width: 48px;
				height: 48px;
				border: 5px solid #fff;
				border-bottom-color: #0067ad;
				border-radius: 50%;
				display: inline-block;
				box-sizing: border-box;
				animation: rotation 1s linear infinite;
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
			}

			@keyframes rotation {
				0% {
				transform: rotate(0deg);
				}
				100% {
				transform: rotate(360deg);
				}
			}
		</style>
		<script>
			setTimeout(function () {
				document.querySelector(".loader").style.display = "none";
			}, 5000);
		</script>
		<script type="text/javascript" src="./index-carina-prod_files/esw.min.js.baixados"></script>

		<script type="text/javascript">
			function isProduction() {
				if (typeof window !== "undefined") {
					var hostname = window.location.hostname;
					console.log('hostname: ' + hostname);
					return !(hostname.includes("localhost") || hostname.includes("ngrok") || hostname.includes("-qa"));
				}
			}

			function setPreChat(){
				let urlParams = new URLSearchParams(window.location.search);
				let origem = urlParams.get("origem");
				let menu = urlParams.get("menu");

				if (origem === "App" || origem === "APP") {
					window.addEventListener( "onEmbeddedMessagingReady" , ( ) => { 
						console.log ( "Received the APP event…"); 
						embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { 
							"Origem" : "App - Meu Carrefour"
						}); 
					});

				} else if ((origem === "DMA" || origem === "SiteAreaLogada" || origem === "Site") && menu) {
					window.addEventListener( "onEmbeddedMessagingReady" , ( ) => { 
						console.log ( "Received the DMA, SiteAreaLogada, Site event…"); 
						embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields( { 
							"Origem" : origem,
							"RedirectDMAVarejo" : menu
						}); 
					});

				} else {
					alert("Erro ao carregar o chat");
				}
			}

			function initEmbeddedMessaging() {
				console.log('initEmbeddedMessaging chamado');
				console.log('Ambiente de produção?', isProduction());

				var chatbotAvatarImgURL = isProduction()
				? "https://carrefourservice.file.force.com/sfc/dist/version/renditionDownload?rendition=ORIGINAL_Png&versionId=068Hs00000nNkZ7&operationContext=DELIVERY&contentId=05THs00002zvlaF&page=0&d=/a/Hs000001VdSd/0vgl2KIIGUKxdPy6X0OvGyG5_nPEkxikG6QR7r2QGBo&oid=00DHs00000NDcMH&dpt=null&viewId="
				: "https://carrefourservice--varejohml.sandbox.file.force.com/sfc/dist/version/renditionDownload?rendition=ORIGINAL_Png&versionId=068D50000032MrU&operationContext=DELIVERY&contentId=05TD5000007k3n7&page=0&d=/a/D500000015aR/FliLu17zp9UQohcPBQnq84RS5HOO.q46LBcoOGP3OZ0&oid=00DD50000009T77&dpt=null&viewId=";
 	
				var scrt2URL = isProduction()
				? 'https://carrefourservice.my.salesforce-scrt.com'
				: 'https://carrefourservice--varejohml.sandbox.my.salesforce-scrt.com';

				var urlInitSites = isProduction()
				? 'https://carrefourservice.my.site.com/ESWChatSamsEnhanced1768353344484'
				: 'https://carrefourservice--varejohml.sandbox.my.site.com/ESWChatSamsClubEnhanced1767014819141';

				var codeGslbBaseURL = isProduction()
				? '00DHs00000NDcMH'
				: '00DD50000009T77';

				var botName = isProduction()
				? 'Chat_Sams_Enhanced'
				: 'ChatSamsClubEnhanced';

				setPreChat();

				embeddedservice_bootstrap.settings.hideChatButtonOnLoad = true;
				embeddedservice_bootstrap.settings.displayHelpButton = false;
				embeddedservice_bootstrap.settings.language = 'pt-BR';

				embeddedservice_bootstrap.settings.enabledFeatures = ['LiveAgent'];
				embeddedservice_bootstrap.settings.entryFeature = 'LiveAgent';

				embeddedservice_bootstrap.settings.chatbotAvatarImgURL = chatbotAvatarImgURL;
				embeddedservice_bootstrap.settings.smallCompanyLogoImgURL = chatbotAvatarImgURL;

				embeddedservice_bootstrap.init(
					codeGslbBaseURL,
					botName,
					urlInitSites,
					{
						scrt2URL: scrt2URL
					}
				);

				console.log('embeddedservice_bootstrap.init finalizado');
				setTimeout(function () {
					handleOpenChat();
				}, 500);
			};

			(function () {
				var urlEmbeddedservice = isProduction()
				? 'https://carrefourservice.my.site.com/ESWChatSamsEnhanced1768353344484/assets/js/bootstrap.min.js'
				: 'https://carrefourservice--varejohml.sandbox.my.site.com/ESWChatSamsClubEnhanced1767014819141/assets/js/bootstrap.min.js';

				console.log('URL do script esw.min.js:', urlEmbeddedservice);

				if (!window.embeddedservice_bootstrap) {
					console.log('embeddedservice_bootstrap não encontrado. Carregando script...');
					var s = document.createElement('script');
					s.setAttribute('src', urlEmbeddedservice);
					s.onload = function () {
						console.log('Script esw.min.js carregado');
						initEmbeddedMessaging();
					};

					s.onerror = function () {
						console.error('Erro ao carregar esw.min.js');
					};

					document.body.appendChild(s);
				} else {
					console.log('embeddedservice_bootstrap já está disponível. Inicializando...');
					initEmbeddedMessaging();
				}
			})();

			function handleOpenChat () {
				console.log('handleOpenChat acionado');
				if (window.embeddedservice_bootstrap) {
					console.log('Chamando bootstrapEmbeddedService');
					embeddedservice_bootstrap.utilAPI.launchChat();
				} else {
					console.warn('embeddedservice_bootstrap não está disponível no handleOpenChat');
				}
			};
		</script>
		<script src="./index-carina-prod_files/esw.min(1).js.baixados"></script>
	</body>
</html>
